-- LeoTestMenu.lua (temiz, tek dosya halinde)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- GUI oluşturma
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "LeoTestMenuGui"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.BackgroundColor3 = Color3.fromRGB(51,51,51)
MainFrame.Size = UDim2.new(0, 300, 0, 500)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -250)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)

local TitleLabel = Instance.new("TextLabel", MainFrame)
TitleLabel.Size = UDim2.new(1, 0, 0, 50)
TitleLabel.Text = "Hile Menüsü"
TitleLabel.TextColor3 = Color3.new(1,1,1)
TitleLabel.BackgroundColor3 = Color3.fromRGB(64,64,64)
TitleLabel.TextScaled = true

local function createButton(name, y)
    local btn = Instance.new("TextButton")
    btn.Parent = MainFrame
    btn.Size = UDim2.new(0, 260, 0, 40)
    btn.Position = UDim2.new(0, 20, 0, y)
    btn.Text = name .. " (Kapalı)"
    btn.BackgroundColor3 = Color3.fromRGB(77,77,77)
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextScaled = true

    btn.MouseEnter:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(95,95,95) end)
    btn.MouseLeave:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(77,77,77) end)
    return btn
end

local AllGamepassesButton = createButton("Bütün Gamepass'leri Al", 60)
local VIPButton = createButton("VIP Al", 110)
local NoClipButton = createButton("NoClip", 160)
local SpeedButton = createButton("Speed Ayarı", 210)
local JumpButton = createButton("Jump Ayarı", 260)
local FlyButton = createButton("Uç", 310)

local CloseButton = Instance.new("TextButton", MainFrame)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -40, 0, 6)
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(200,50,50)
CloseButton.TextColor3 = Color3.new(1,1,1)
CloseButton.TextScaled = true
CloseButton.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

-- NoClip
local noclipActive = false
NoClipButton.MouseButton1Click:Connect(function()
    noclipActive = not noclipActive
    NoClipButton.Text = noclipActive and "NoClip (Açık)" or "NoClip (Kapalı)"
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") then
            -- Sadece oyuncu parçalarına dokunma istersen ek filtre koy
            v.CanCollide = not noclipActive and true or false
        end
    end
end)

-- Speed
local speedActive = false
SpeedButton.MouseButton1Click:Connect(function()
    speedActive = not speedActive
    SpeedButton.Text = speedActive and "Speed Ayarı (Açık)" or "Speed Ayarı (Kapalı)"
    local char = player.Character
    if char and char:FindFirstChildOfClass("Humanoid") then
        char:FindFirstChildOfClass("Humanoid").WalkSpeed = speedActive and 50 or 16
    end
end)

-- Jump
local jumpActive = false
JumpButton.MouseButton1Click:Connect(function()
    jumpActive = not jumpActive
    JumpButton.Text = jumpActive and "Jump Ayarı (Açık)" or "Jump Ayarı (Kapalı)"
    local char = player.Character
    if char and char:FindFirstChildOfClass("Humanoid") then
        char:FindFirstChildOfClass("Humanoid").JumpPower = jumpActive and 100 or 50
    end
end)

-- Fly (RunService ile güvenli update)
local flyActive = false
local flyBV = nil
local flyConn = nil

local function startFly()
    local char = player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    flyBV = Instance.new("BodyVelocity")
    flyBV.MaxForce = Vector3.new(1e5, 1e5, 1e5)
    flyBV.Parent = hrp

    flyConn = RunService.Heartbeat:Connect(function()
        if not flyActive or not hrp then return end
        local look = mouse.Hit.lookVector
        local vx = look.X * 50
        local vz = look.Z * 50
        local vy = 0
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            vy = 50
        elseif UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
            vy = -50
        end
        flyBV.Velocity = Vector3.new(vx, vy, vz)
    end)
end

local function stopFly()
    if flyConn then
        flyConn:Disconnect()
        flyConn = nil
    end
    if flyBV then
        flyBV:Destroy()
        flyBV = nil
    end
end

FlyButton.MouseButton1Click:Connect(function()
    flyActive = not flyActive
    FlyButton.Text = flyActive and "Uç (Açık)" or "Uç (Kapalı)"
    if flyActive then
        startFly()
    else
        stopFly()
    end
end)

-- Basit simülasyon butonları
AllGamepassesButton.MouseButton1Click:Connect(function()
    AllGamepassesButton.Text = "Bütün Gamepass'leri Al (Denendi)"
    warn("Gamepass alma simülasyonu çalıştı - gerçek bypass içermez.")
end)

VIPButton.MouseButton1Click:Connect(function()
    VIPButton.Text = "VIP Al (Denendi)"
    warn("VIP simülasyonu çalıştı - gerçek bypass içermez.")
end)

-- Karakter yeniden doğduğunda varsayılanları geri ayarla
player.CharacterAdded:Connect(function(char)
    wait(0.5)
    local hum = char:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.WalkSpeed = speedActive and 50 or 16
        hum.JumpPower = jumpActive and 100 or 50
    end
end)
